<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Редактирование заявки</title>
</head>
<body>
<form th:method="PATCH" th:action="@{/proposals/{proposalId}(proposalId=${proposal.getId()})}" th:object="${proposal}">
    <label for="name">Дата: </label>
    <input id="name" type="date" th:field="*{date}">
    <input th:type="hidden" th:field="*{id}" />
    <input type="submit" value="Изменить">
    <a th:href="@{/proposals}"><button type="button">Готово</button></a>
</form>
<table>
    <tr><th>№</th><th>Название</th><th>Стоимость</th><th>Количество</th><th></th></tr>
    <tr th:each="menu, iState: ${addedMenus}">
        <td th:text="${iState.count}"></td>
        <td><a target = "_blank" th:href="@{/menus/{menuId}(menuId=${menu.getId()})}" th:text="${menu.getName()}"></a></td>
        <td th:text="${addedPrices.get(iState.count - 1)}"></td>
        <td th:text="${proposalElements.get(iState.count - 1).getCount()}"></td>
        <td>
            <form th:method="DELETE" th:object="${delElement}" th:action="@{/proposals/{proposalId}/{menuId}(menuId=${menu.getId()}, proposalId=${proposal.getId()})}">
                <input type="hidden" name="count" th:value="${proposalElements.get(iState.count - 1).getCount()}">
                <input type="hidden" name="id" th:value="${proposalElements.get(iState.count - 1).getId()}">
                <input type="hidden" name="proposalId" th:value="${proposalElements.get(iState.count - 1).getProposalId()}">
                <input type="hidden" name="menuId" th:value="${proposalElements.get(iState.count - 1).getMenuId()}">
                <button type="submit">X</button>
            </form>
        </td>
    </tr>
    <tr><td></td><td></td><td th:text="${sum}"></td></tr>
</table>
<table>
    <tr><th>№</th><th>Название</th><th>Стоимость</th><th>Количество</th><th></th></tr>
    <tr th:each="menu, iState: ${menus}">
        <td th:text="${iState.count}"></td>
        <td><a target = "_blank" th:href="@{/menus/{menuId}(menuId=${menu.getId()})}" th:text="${menu.getName()}"></a></td>
        <td th:text="${prices.get(iState.count - 1)}"></td>
        <form th:method="POST" th:object="${proposalElement}" th:action="@{/proposals/{proposalId}/{menuId}(proposalId=${proposal.getId()}, menuId=${menu.getId()})}">
            <td><input size="2" min="1" type="number" th:field="*{count}"> шт.</td>
            <td><button type="submit">+</button></td>
        </form>
    </tr>
</table>
</body>
</html>